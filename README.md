# Keepalived и проверка работоспособности сервиса СУБД MySQL
Зачастую для того, чтобы выяснить, кто из серверов в кластере отказоустойчивости должен брать на себя статус MASTER на плавающий IP-адрес, необходимо, чтобы сервер был не только доступен в сети, но и была доступность службы, с которой мы работаем. 

Для примера возьмем СУБД MySQL, где напишем в конфигурационном скрипте keepalived путь на BASH скрипт, который выясняет статус active (running), где в скрипт возвращает код 0 сервису keealived, что значит выполнилось успешно. Если же служба находится в статусе stop, fault, то код возврата будет 1 и сервис keepalived сочтет это за сбой работы сервиса и передаче статуса MASTER другой ноде в кластере.

И так, разберем код скрипта: 
```bash
#!/bin/bash
# Название службы MySQL, обычно это mysql или mysqld
# Проверка статуса службы
if [ \$(systemctl is-active mysql) == "inactive" ];
then
# Возвращаем код выхода 1, если служба неактивна
exit 1
else
# Возвращаем код выхода 0 (нет ошибки), если служба активна
echo 0
fi
```
